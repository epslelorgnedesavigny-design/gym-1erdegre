<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gymnastique √âcole ü§∏‚Äç‚ôÄÔ∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="gym_data.js"></script>
    <style>
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .bg-SOL { background-color: #ef4444; } .bg-POUTRE { background-color: #10b981; } .bg-BARRES { background-color: #3b82f6; }
        .border-SOL { border-color: #ef4444; } .border-POUTRE { border-color: #10b981; } .border-BARRES { border-color: #3b82f6; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 h-screen overflow-hidden">
<div id="app" class="flex h-full">

    <aside :class="['bg-slate-900 text-white h-full z-40 transition-all flex flex-col shadow-xl absolute lg:relative', isSidebarOpen ? 'w-80' : 'w-0 overflow-hidden lg:w-0']">
        <div class="p-6 border-b border-slate-800 flex justify-between items-center shrink-0">
            <h1 class="font-black italic text-xl uppercase tracking-tighter text-blue-400">Gym √âcole ü§∏‚Äç‚ôÄÔ∏è</h1>
            <button @click="isSidebarOpen = false" class="text-slate-500 hover:text-white"><i class="fas fa-times text-xl"></i></button>
        </div>
        <div class="flex-1 overflow-y-auto p-4 space-y-6">
            <div v-for="agre in ['SOL', 'POUTRE', 'BARRES']" :key="agre">
                <div class="flex items-center gap-2 mb-2">
                    <div :class="['w-2 h-2 rounded-full', 'bg-'+agre]"></div>
                    <span class="text-[10px] font-black uppercase text-slate-500 tracking-widest">{{ agre }}</span>
                </div>
                <div v-for="action in getActions(agre)" :key="action">
                    <button @click="toggleFolder(agre+action)" class="w-full text-left p-2 hover:bg-slate-800 rounded-lg flex justify-between items-center text-xs font-bold transition">
                        {{ action }} <i :class="['fas fa-chevron-right text-[10px] transition', openFolders.includes(agre+action) ? 'rotate-90 text-blue-400' : '']"></i>
                    </button>
                    <div v-show="openFolders.includes(agre+action)" class="ml-4 border-l border-slate-800 pl-2 my-1">
                        <button v-for="el in getElements(agre, action)" @click="selectElement(el)" :class="['block w-full text-left p-2 text-xs transition', curr?.id === el.id ? 'text-blue-400 font-black bg-slate-800 rounded' : 'text-slate-400 hover:text-white']">
                            {{ el.nom }}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col overflow-hidden">
        <header class="bg-white border-b p-4 flex items-center justify-between px-8 shadow-sm">
            <div class="flex items-center gap-4">
                <button @click="isSidebarOpen = true" v-show="!isSidebarOpen" class="text-blue-600 mr-2"><i class="fas fa-bars text-xl"></i></button>
                <div v-if="curr" class="flex items-center gap-4">
                    <span :class="['text-[10px] font-black px-2 py-0.5 rounded text-white uppercase', 'bg-'+curr.agre]">{{ curr.agre }}</span>
                    <span class="font-black uppercase tracking-tight text-xl">{{ curr.nom }}</span>
                    <span class="bg-amber-100 text-amber-700 px-3 py-1 rounded-full text-[10px] font-black tracking-widest uppercase ml-2">Difficult√© : {{ curr.difficulte }}</span>
                </div>
            </div>
            <button @click="curr = null" class="w-10 h-10 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-400 transition"><i class="fas fa-home text-xl"></i></button>
        </header>

        <div class="flex-1 overflow-y-auto p-4 md:p-10">
            <div v-if="!curr" class="max-w-6xl mx-auto h-full flex flex-col justify-center items-center">
                <h2 class="text-4xl font-black text-slate-300 uppercase mb-12 italic text-center">Choisissez un agr√®s</h2>
                <div class="grid md:grid-cols-3 gap-10 w-full px-4">
                    <div v-for="a in ['SOL', 'POUTRE', 'BARRES']" @click="openAgre(a)" class="group bg-white rounded-[3rem] shadow-2xl hover:scale-105 transition cursor-pointer overflow-hidden border-b-[12px]" :class="'border-'+a">
                        <img :src="'IMAGES/' + a + '.jpg'" class="w-full h-80 object-cover group-hover:opacity-90 transition duration-500">
                    </div>
                </div>
            </div>

            <div v-else class="max-w-4xl mx-auto space-y-10 pb-20">
                <div @click="openModal(curr, '√âl√©ment')" class="bg-black rounded-[3rem] overflow-hidden shadow-2xl relative aspect-video border-[10px] border-white group cursor-pointer">
                    <img :src="'IMAGES/'+currentFile(curr, globalView)" class="w-full h-full object-contain">
                    <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity"><i class="fas fa-expand text-white text-5xl"></i></div>
                </div>

                <div class="grid md:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="bg-blue-50/50 p-5 rounded-[2.5rem] border border-blue-100 flex items-center gap-3">
                            <div class="w-7 h-7 shrink-0 bg-blue-600 rounded-full flex items-center justify-center shadow-md"><i class="fas fa-info text-white text-[12px]"></i></div>
                            <h4 class="text-base font-black text-blue-700 uppercase">Comment faire ?</h4>
                        </div>
                        <ul class="space-y-3 px-4">
                            <li v-for="c in curr.criteres_realisation" class="text-sm font-bold text-slate-700 italic flex gap-3">
                                <i class="fas fa-chevron-right text-blue-400 mt-1 shrink-0"></i> {{ c }}
                            </li>
                        </ul>
                    </div>

                    <div class="space-y-6">
                        <div class="bg-emerald-50/50 p-5 rounded-[2.5rem] border border-emerald-100 flex items-center gap-3">
                            <div class="w-7 h-7 shrink-0 bg-emerald-500 rounded-full flex items-center justify-center shadow-md"><i class="fas fa-check text-white text-[12px]"></i></div>
                            <h4 class="text-base font-black text-emerald-700 uppercase">C'est r√©ussi si...</h4>
                        </div>
                        <ul class="space-y-3 px-4">
                            <li v-for="c in curr.criteres_reussite" class="text-sm font-bold text-slate-700 flex gap-3">
                                <i class="fas fa-check-circle text-emerald-500 mt-1 shrink-0"></i> {{ c }}
                            </li>
                        </ul>
                    </div>
                </div>

                <section v-if="curr.etapes && curr.etapes.length">
                    <h4 class="text-lg font-black text-slate-600 uppercase tracking-widest mb-6 italic border-l-8 border-blue-400 pl-4">Progression sugg√©r√©e</h4>
                    <div class="flex gap-6 overflow-x-auto pb-6 hide-scrollbar">
                        <div v-for="(et, index) in curr.etapes" @click="openModal(et, '√âtape')" class="w-72 shrink-0 bg-white p-4 rounded-[2.5rem] border shadow-sm cursor-pointer hover:border-blue-500 transition">
                            <img :src="'IMAGES/'+(et.media.face || et.media.profil)" class="rounded-[1.5rem] aspect-video object-cover mb-4">
                            <p class="text-[11px] font-bold uppercase text-slate-600">
                                <span class="text-blue-600 font-black">√âTAPE {{ index + 1 }} :</span> {{ et.nom }}
                            </p>
                        </div>
                    </div>
                </section>

                <section v-if="curr.erreurs && curr.erreurs.length">
                    <h4 class="text-lg font-black text-rose-500 uppercase tracking-widest mb-6 italic border-l-8 border-rose-400 pl-4">Erreurs courantes</h4>
                    <div class="flex gap-4 overflow-x-auto pb-6 hide-scrollbar">
                        <div v-for="er in curr.erreurs" @click="openModal(er, 'Erreur')" class="w-64 shrink-0 bg-white p-3 rounded-[2rem] border-2 border-rose-50 shadow-sm cursor-pointer hover:border-rose-400 transition">
                            <img :src="'IMAGES/'+(er.media.face || er.media.profil)" class="rounded-2xl aspect-video object-cover mb-3">
                            <p class="text-[10px] font-black uppercase text-center text-rose-600">{{ er.titre }}</p>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <transition name="fade">
        <div v-if="modal" class="fixed inset-0 z-[100] bg-slate-900/95 flex items-center justify-center p-4" @click.self="closeModal">
            <div class="bg-white w-full max-w-6xl rounded-[3rem] overflow-hidden shadow-2xl relative flex flex-col md:flex-row h-[90vh] md:h-auto overflow-y-auto md:overflow-hidden">
                <button @click="closeModal" class="absolute top-6 right-6 z-10 w-12 h-12 bg-black/10 rounded-full flex items-center justify-center hover:bg-black/20 transition"><i class="fas fa-times text-xl"></i></button>
                
                <div class="md:w-1/2 bg-black flex items-center justify-center aspect-video md:aspect-auto">
                    <img :src="'IMAGES/'+currentFile(modal.data, modalView)" class="w-full h-full object-contain">
                </div>
                
                <div class="md:w-1/2 p-8 md:p-12 flex flex-col justify-center overflow-y-auto hide-scrollbar">
                    <span class="text-blue-600 font-black text-[10px] uppercase mb-2 tracking-widest">{{ modal.type }}</span>
                    <h2 class="text-3xl font-black uppercase mb-8 leading-tight">{{ modal.data.nom || modal.data.titre }}</h2>
                    
                    <div v-if="modal.type === '√âl√©ment'" class="space-y-8">
                        <div>
                            <p class="text-[10px] font-black text-blue-600 uppercase mb-3 italic">Comment faire ?</p>
                            <ul class="space-y-2">
                                <li v-for="c in modal.data.criteres_realisation" class="text-sm font-bold text-slate-700 italic flex gap-3">
                                    <i class="fas fa-chevron-right text-blue-400 mt-1 shrink-0 text-[10px]"></i> {{ c }}
                                </li>
                            </ul>
                        </div>
                        <div>
                            <p class="text-[10px] font-black text-emerald-600 uppercase mb-3 italic">C'est r√©ussi si...</p>
                            <ul class="space-y-2">
                                <li v-for="c in modal.data.criteres_reussite" class="text-sm font-bold text-slate-700 flex gap-3">
                                    <i class="fas fa-check-circle text-emerald-500 mt-1 shrink-0 text-[10px]"></i> {{ c }}
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div v-if="modal.data.correction" class="bg-amber-50 p-6 rounded-[2rem] border border-amber-100">
                        <p class="text-[10px] font-black text-amber-700 uppercase mb-2 italic">Conseil de correction :</p>
                        <p class="text-base font-bold text-amber-900 italic leading-snug">{{ modal.data.correction }}</p>
                    </div>

                    <div v-if="modal.type === '√âtape'" class="text-slate-500 italic text-sm font-medium">
                        Travaillez cette √©tape pour ma√Ætriser l'√©l√©ment complet.
                    </div>
                </div>
            </div>
        </div>
    </transition>
</div>

<script>
const { createApp } = Vue;
createApp({
    data() {
        return { isSidebarOpen: true, curr: null, openFolders: [], globalView: 'face', modalView: 'face', globalTimer: null, modalTimer: null, modal: null }
    },
    methods: {
        getActions(agre) { return [...new Set(gymData.filter(d => d.agre === agre).map(d => d.action))]; },
        getElements(a, ac) { return gymData.filter(d => d.agre === a && d.action === ac); },
        toggleFolder(k) { const i = this.openFolders.indexOf(k); i > -1 ? this.openFolders.splice(i, 1) : this.openFolders.push(k); },
        openAgre(a) { this.isSidebarOpen = true; this.openFolders = [a + this.getActions(a)[0]]; this.curr = null; },
        currentFile(item, view) { if (!item?.media) return ''; const m = item.media; return (view === 'face' && m.face) ? m.face : (m.profil || m.face); },
        selectElement(el) {
            this.curr = el; this.globalView = 'face'; 
            if(this.globalTimer) clearInterval(this.globalTimer);
            if(el.media.face && el.media.profil) {
                this.globalTimer = setInterval(() => { this.globalView = (this.globalView === 'face' ? 'profil' : 'face'); }, 4000);
            }
            if(window.innerWidth < 1024) this.isSidebarOpen = false;
        },
        openModal(item, type) {
            this.modal = { data: item, type: type };
            this.modalView = 'face';
            if(this.modalTimer) clearInterval(this.modalTimer);
            if(item.media && item.media.face && item.media.profil) {
                this.modalTimer = setInterval(() => { this.modalView = (this.modalView === 'face' ? 'profil' : 'face'); }, 4000);
            }
        },
        closeModal() { clearInterval(this.modalTimer); this.modal = null; }
    }
}).mount('#app');
</script>
</body>
</html>
